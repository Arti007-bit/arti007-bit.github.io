<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8" />
<title>Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§</title>
<style>
body { 
  font-family: "Vazir", sans-serif;
  direction: rtl;
  margin: 40px;
  background: #fafafa;
}
h1 { color: #333; }
table { width: 100%; border-collapse: collapse; margin-top: 20px; background: #fff; }
th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
button { cursor: pointer; padding: 4px 8px; margin: 0 3px; }

.cart-buttons {
  margin-top: 20px;
}

.clear-cart,
.finalize-cart {
  display: inline-block;
  color: #fff;
  border: none;
  padding: 10px 18px;
  margin: 5px;
  border-radius: 5px;
  text-decoration: none;
  cursor: pointer;
  transition: 0.3s;
  font-size: 15px;
}

.clear-cart { background-color: #d33; }
.finalize-cart { background-color: #4CAF50; }

.clear-cart:hover { background-color: #b22; }
.finalize-cart:hover { background-color: #45a049; }

.total {
  font-weight: bold;
  color: green;
  margin-top: 20px;
}
a { text-decoration: none; color: #007bff; }
</style>
</head>

<body>
  <div class="cart-container">
    <h1>ğŸ›’ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§</h1>

    <table id="cart-table">
      <thead>
        <tr>
          <th>Ù†Ø§Ù… Ù…Ø­ØµÙˆÙ„</th>
          <th>Ù‚ÛŒÙ…Øª ÙˆØ§Ø­Ø¯</th>
          <th>ØªØ¹Ø¯Ø§Ø¯</th>
          <th>Ø¬Ù…Ø¹ Ú©Ù„</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <p class="total"></p>

    <div class="cart-buttons">
      <button id="clear-cart" class="clear-cart">ğŸ—‘ï¸ Ø®Ø§Ù„ÛŒ Ú©Ø±Ø¯Ù† Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯</button>
      <a href="checkout.html" class="finalize-cart">Ù†Ù‡Ø§ÛŒÛŒ Ú©Ø±Ø¯Ù† Ø®Ø±ÛŒØ¯</a>
    </div>

    <br><br>
    <a href="index.html">â¬…ï¸ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ÙØ±ÙˆØ´Ú¯Ø§Ù‡</a>
  </div>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const tbody = document.querySelector("#cart-table tbody");
    const totalElement = document.querySelector(".total");
    const clearBtn = document.getElementById("clear-cart");

    tbody.innerHTML = "";
    let total = 0;

    if (cart.length === 0) {
      tbody.innerHTML = `<tr><td colspan="4">Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø´Ù…Ø§ Ø®Ø§Ù„ÛŒ Ø§Ø³Øª ğŸ›’</td></tr>`;
      totalElement.innerText = "";
      clearBtn.style.display = "none";
      return;
    }

    cart.forEach((item, index) => {

      /* â­â­â­ ÙÙ‚Ø· Ù‡Ù…ÛŒÙ† Ø®Ø· Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡ â­â­â­ */
      const name = item.title || "Ù†Ø§Ù… Ù…Ø­ØªØµÙˆÙ„";
      const price = Number(item.price) || 0;
      const quantity = Number(item.quantity) || 1;
      const subtotal = price * quantity;
      total += subtotal;

      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${name}</td>
        <td>${price.toLocaleString()} ØªÙˆÙ…Ø§Ù†</td>
        <td>
          <button class="dec">-</button>
          ${quantity}
          <button class="inc">+</button>
        </td>
        <td>${subtotal.toLocaleString()} ØªÙˆÙ…Ø§Ù†</td>
      `;
      tbody.appendChild(tr);

      tr.querySelector(".inc").addEventListener("click", () => {
        item.quantity = quantity + 1;
        localStorage.setItem("cart", JSON.stringify(cart));
        location.reload();
      });

      tr.querySelector(".dec").addEventListener("click", () => {
        if (quantity > 1) {
          item.quantity = quantity - 1;
        } else {
          cart.splice(index, 1);
        }
        localStorage.setItem("cart", JSON.stringify(cart));
        location.reload();
      });
    });

    totalElement.innerText = `ğŸ’° Ù…Ø¬Ù…ÙˆØ¹ Ú©Ù„: ${total.toLocaleString()} ØªÙˆÙ…Ø§Ù†`;

    clearBtn.addEventListener("click", () => {
      if (confirm("Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø³Ø¨Ø¯ Ø®Ø±ÛŒØ¯ Ø±Ø§ Ø®Ø§Ù„ÛŒ Ú©Ù†ÛŒØ¯ØŸ")) {
        localStorage.removeItem("cart");
        location.reload();
      }
    });
  });
  </script>
</body>
</html>
